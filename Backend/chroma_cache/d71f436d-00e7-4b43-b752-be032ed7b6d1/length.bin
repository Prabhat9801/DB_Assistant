invalid type: string "WITH raw_data AS (\n    SELECT *,\n    CASE\n        WHEN planned_date ~ '^[0-9]{2}/[0-9]{2}/[0-9]{4}$' THEN TO_TIMESTAMP(planned_date, 'DD/MM/YYYY')\n        WHEN planned_date ~ '^[0-9]{4}-[0-9]{2}-[0-9]{2}' THEN planned_date::timestamp\n        ELSE NULL\n    END as clean_date\n    FROM checklist\n)\nSELECT COUNT(*) AS pending_count\nFROM raw_data c\n÷þýüû